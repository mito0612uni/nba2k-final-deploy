# Buildpacksは、Dockerfileが存在しない場合に自動的に実行されます。
# ここでは、デプロイとログ設定のみを記述します。

steps:
# 1. Buildpacksによって自動生成されたイメージをデプロイする
- name: 'gcr.io/google.com/cloudsdktool/cloud-sdk'
  entrypoint: gcloud
  args: [
    'run', 'deploy', 'nba2k26-jpl',
    '--image', 'gcr.io/$PROJECT_ID/source:$COMMIT_SHA', # Buildpacksが生成するイメージ名
    '--region', 'asia-northeast1',
    '--allow-unauthenticated',
    '--platform', 'managed'
  ]
  id: 'Deploy to Cloud Run'

options:
  # ログ設定のエラーを回避するため、この行が必須です
  logging: CLOUD_LOGGING_ONLY