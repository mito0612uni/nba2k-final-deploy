{% extends "layout.html" %}
{% block content %}
<style>
    /* --- ç®¡ç†ç”»é¢å…±é€šã‚¹ã‚¿ã‚¤ãƒ« --- */
    body { background-color: #f4f6f9; } /* å…¨ä½“ã®èƒŒæ™¯ã‚’å°‘ã—ã‚°ãƒ¬ãƒ¼ã« */
    .admin-container { max-width: 1000px; margin: 40px auto; padding: 0 15px; }
    
    .page-header {
        display: flex; align-items: center; justify-content: space-between;
        margin-bottom: 30px; border-bottom: 2px solid #e9ecef; padding-bottom: 15px;
    }
    .page-header h2 { margin: 0; color: #2c3e50; font-weight: 700; font-size: 1.8rem; }
    .page-header .icon { margin-right: 10px; color: #007bff; }

    /* ã‚«ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ« */
    .admin-card {
        background: #ffffff; border-radius: 12px; border: none;
        box-shadow: 0 5px 15px rgba(0,0,0,0.05); margin-bottom: 25px; overflow: hidden;
        transition: transform 0.2s;
    }
    .card-header {
        background: #fff; border-bottom: 1px solid #f0f0f0; padding: 20px 25px;
        font-weight: 700; color: #34495e; font-size: 1.1rem;
    }
    .card-body { padding: 25px; }

    /* ãƒ•ã‚©ãƒ¼ãƒ è¦ç´  */
    .form-group label { font-weight: 600; color: #555; margin-bottom: 8px; display: block; }
    .form-control {
        border-radius: 8px; border: 1px solid #ddd; padding: 12px; font-size: 1rem; width: 100%; box-sizing: border-box;
        background-color: #fdfdfd; transition: border-color 0.2s;
    }
    .form-control:focus { border-color: #007bff; box-shadow: 0 0 0 3px rgba(0,123,255,0.1); outline: none; }
    
    .btn-submit {
        background: linear-gradient(135deg, #007bff 0%, #0056b3 100%); color: white;
        border: none; padding: 12px 30px; border-radius: 30px; font-weight: bold;
        box-shadow: 0 4px 10px rgba(0,123,255,0.3); transition: transform 0.2s; cursor: pointer;
    }
    .btn-submit:hover { transform: translateY(-2px); box-shadow: 0 6px 15px rgba(0,123,255,0.4); }

    /* é€Ÿå ±è¨­å®šç”¨ã®ç‰¹åˆ¥ãƒœã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ« */
    .btn-warning-grad {
        background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%); color: #333;
        box-shadow: 0 4px 10px rgba(255, 152, 0, 0.3);
    }
    .btn-warning-grad:hover { box-shadow: 0 6px 15px rgba(255, 152, 0, 0.4); }

    /* ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒªã‚¹ãƒˆ */
    .news-list-item {
        display: flex; gap: 20px; padding: 20px; border-bottom: 1px solid #eee;
        align-items: start; background: #fff; transition: background 0.2s;
    }
    .news-list-item:last-child { border-bottom: none; }
    .news-list-item:hover { background-color: #fafafa; }
    
    .news-thumb {
        width: 120px; height: 90px; object-fit: cover; border-radius: 8px;
        background-color: #eee; flex-shrink: 0; border: 1px solid #ddd;
    }
    .news-content-area { flex-grow: 1; }
    .news-title { margin: 0 0 5px; font-size: 1.2rem; font-weight: 700; color: #2c3e50; }
    .news-meta { font-size: 0.85rem; color: #888; margin-bottom: 10px; display: block; }
    .news-text { color: #555; line-height: 1.5; font-size: 0.95rem; white-space: pre-wrap; margin: 0; }
    
    .btn-delete {
        background-color: #fff; color: #dc3545; border: 1px solid #dc3545;
        padding: 5px 15px; border-radius: 20px; font-size: 0.85rem; cursor: pointer;
        transition: all 0.2s;
    }
    .btn-delete:hover { background-color: #dc3545; color: white; }
    
    .nav-btn {
        display: inline-block; margin-top: 20px; color: #6c757d; text-decoration: none; font-weight: 500;
    }
    .nav-btn:hover { color: #343a40; text-decoration: underline; }
</style>

<div class="admin-container">
    <div class="page-header">
        <h2><span class="icon">ğŸ“¢</span>ãŠçŸ¥ã‚‰ã›ç®¡ç†</h2>
    </div>
    
    <div class="admin-card" style="border: 2px solid #ffeeba;">
        <div class="card-header" style="background-color: #fff3cd; color: #856404; display: flex; align-items: center; gap: 10px;">
            <span style="font-size: 1.2em;">âš¡</span> ãƒ‹ãƒ¥ãƒ¼ã‚¹é€Ÿå ±ãƒãƒ¼è¨­å®š (Breaking News)
        </div>
        <div class="card-body">
            <form method="post">
                <input type="hidden" name="action" value="update_ticker">
                
                <div class="form-group">
                    <label>è¡¨ç¤ºãƒ†ã‚­ã‚¹ãƒˆ</label>
                    <input type="text" name="ticker_text" class="form-control" 
                           placeholder="ä¾‹: æœ¬æ—¥21æ™‚ã‚ˆã‚Š ãƒ—ãƒ¬ã‚¤ã‚ªãƒ•æ±ºå‹æˆ¦ Aãƒãƒ¼ãƒ  vs Bãƒãƒ¼ãƒ ï¼ ç”Ÿé…ä¿¡ã‚’ãŠè¦‹é€ƒã—ãªãï¼" 
                           value="{{ ticker_text }}">
                    <small class="text-muted">ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ä¸Šéƒ¨ã«æµã‚Œã‚‹ãƒ†ã‚­ã‚¹ãƒˆã§ã™ã€‚</small>
                </div>
                
                <div class="form-group" style="margin-top: 20px; display:flex; align-items:center;">
                    <input type="checkbox" id="ticker_active" name="ticker_active" value="true" {% if ticker_active %}checked{% endif %} 
                           style="width:20px; height:20px; margin-right:10px; cursor: pointer;">
                    <label for="ticker_active" style="margin:0; cursor:pointer; font-weight:bold;">ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«è¡¨ç¤ºã™ã‚‹</label>
                </div>
                
                <div style="text-align: right; margin-top: 15px;">
                    <button type="submit" class="btn-submit btn-warning-grad">è¨­å®šã‚’ä¿å­˜</button>
                </div>
            </form>
        </div>
    </div>
    <div class="admin-card">
        <div class="card-header">æ–°è¦æŠ•ç¨¿ã‚’ä½œæˆ</div>
        <div class="card-body">
            <form method="post" enctype="multipart/form-data">
                <input type="hidden" name="action" value="add_news">
                
                <div class="form-group">
                    <label>ã‚¿ã‚¤ãƒˆãƒ«</label>
                    <input type="text" name="news_title" class="form-control" placeholder="ä¾‹: ã‚·ãƒ¼ã‚ºãƒ³é–‹å¹•ã®ãŠçŸ¥ã‚‰ã›" required>
                </div>
                
                <div class="form-group">
                    <label>æœ¬æ–‡</label>
                    <textarea name="news_content" class="form-control" rows="5" placeholder="ãŠçŸ¥ã‚‰ã›ã®å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..." required></textarea>
                </div>
                
                <div class="form-group">
                    <label>ç”»åƒæ·»ä»˜ (ä»»æ„)</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="file" name="news_image" class="form-control" style="flex:1; padding:9px;">
                    </div>
                    <small class="text-muted" style="display:block; margin-top:5px;">
                        ã¾ãŸã¯ç”»åƒã®URLã‚’ç›´æ¥æŒ‡å®š: <input type="text" name="news_image_url" class="form-control" placeholder="https://..." style="margin-top:5px;">
                    </small>
                </div>
                
                <div style="text-align: right; margin-top: 20px;">
                    <button type="submit" class="btn-submit">æŠ•ç¨¿ã™ã‚‹</button>
                </div>
            </form>
        </div>
    </div>

    <h3 style="color: #2c3e50; font-size: 1.3rem; margin-bottom: 15px; padding-left: 5px; border-left: 4px solid #007bff;">æŠ•ç¨¿æ¸ˆã¿ã®ãŠçŸ¥ã‚‰ã›</h3>
    
    <div class="admin-card">
        {% if news_items %}
            <div class="news-list">
            {% for item in news_items %}
                <div class="news-list-item">
                    {% if item.image_url %}
                        <img src="{{ item.image_url }}" alt="ã‚µãƒ ãƒã‚¤ãƒ«" class="news-thumb">
                    {% else %}
                        <div class="news-thumb" style="display:flex; align-items:center; justify-content:center; color:#ccc; font-size:2rem;">ğŸ“</div>
                    {% endif %}
                    
                    <div class="news-content-area">
                        <h4 class="news-title">{{ item.title }}</h4>
                        <span class="news-meta">ğŸ“… {{ item.created_at.strftime('%Y/%m/%d %H:%M') }}</span>
                        <p class="news-text">{{ item.content }}</p>
                    </div>
                    
                    <div style="display:flex; flex-direction:column; gap:10px; align-items:flex-end;">
                        <a href="{{ url_for('edit_news', news_id=item.id) }}" style="color:#007bff; text-decoration:none; font-size:0.9rem; font-weight:bold;">ç·¨é›†</a>
                        <form method="post" onsubmit="return confirm('ã“ã®ãŠçŸ¥ã‚‰ã›ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ');">
                            <input type="hidden" name="action" value="delete_news">
                            <input type="hidden" name="news_id" value="{{ item.id }}">
                            <button type="submit" class="btn-delete">å‰Šé™¤</button>
                        </form>
                    </div>
                </div>
            {% endfor %}
            </div>
        {% else %}
            <div style="padding: 40px; text-align: center; color: #999;">
                <p>ã¾ã ãŠçŸ¥ã‚‰ã›ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
            </div>
        {% endif %}
    </div>
    
    <div style="text-align: center;">
        <a href="{{ url_for('roster') }}" class="nav-btn">â† ãƒ­ã‚¹ã‚¿ãƒ¼ç®¡ç†ã¸æˆ»ã‚‹</a>
    </div>
</div>
{% endblock %}