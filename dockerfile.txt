# Python の公式イメージを使う
FROM python:3.11-slim

# コンテナ内で作業するディレクトリを設定
WORKDIR /app

# Pythonの依存関係ファイルをコピーしインストール
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# アプリケーションのコードをすべてコピー
COPY . .

# ポート 8080 を開く (Cloud Run の標準ポート)
ENV PORT 8080

# Gunicorn を使って Flask アプリを起動する
CMD exec gunicorn --bind :$PORT --workers 1 --threads 8 app:app